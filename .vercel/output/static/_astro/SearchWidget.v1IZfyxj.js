import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.D55ewHcJ.js";import{s as g}from"./supabase.CKd-pqSN.js";function y(){const[r,f]=a.useState(""),[i,m]=a.useState([]),[d,u]=a.useState(!1),[x,o]=a.useState(!1),n=a.useRef(null);a.useEffect(()=>{function t(s){n.current&&!n.current.contains(s.target)&&o(!1)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[n]),a.useEffect(()=>{const t=setTimeout(async()=>{if(r.length<2){m([]);return}u(!0);const{data:s,error:l}=await g.from("productos").select(`
            id, nombre, slug, precio,
            imagenes:imagenes_producto(url)
        `).ilike("nombre",`%${r}%`).limit(5);!l&&s&&(m(s),o(!0)),u(!1)},300);return()=>clearTimeout(t)},[r]);const h=(t,s)=>{if(!s)return t;const l=new RegExp(`(${s})`,"gi");return t.split(l).map((c,b)=>l.test(c)?e.jsx("strong",{className:"text-farma-primary font-extrabold",children:c},b):c)},p=t=>{t.preventDefault(),window.location.href=`/buscar?q=${r}`};return e.jsxs("div",{ref:n,className:"relative w-full max-w-lg",children:[e.jsxs("form",{onSubmit:p,className:"relative",children:[e.jsx("input",{type:"text",value:r,onChange:t=>{f(t.target.value),o(!0)},onFocus:()=>r.length>=2&&o(!0),placeholder:"Buscar medicamentos, marcas...",className:"w-full border border-farma-muted rounded-full py-2 px-4 pl-10 focus:outline-none focus:border-farma-primary focus:ring-1 focus:ring-farma-primary bg-white text-farma-text"}),e.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400",children:d?e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-farma-primary border-t-transparent rounded-full"}):"ðŸ”"})]}),x&&r.length>=2&&e.jsx("div",{className:"absolute top-full mt-2 w-full bg-white rounded-xl shadow-xl border border-gray-100 z-50 overflow-hidden",children:d?e.jsx("div",{className:"p-4 text-center text-gray-400 text-sm",children:"Buscando..."}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsx("ul",{children:i.map(t=>e.jsx("li",{children:e.jsxs("a",{href:`/producto/${t.slug}`,className:"flex items-center gap-4 p-3 hover:bg-farma-accent hover:bg-opacity-20 transition-colors border-b border-farma-muted last:border-0",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-white border border-farma-muted rounded overflow-hidden",children:e.jsx("img",{src:t.imagenes?.[0]?.url||"https://placehold.co/50",alt:t.nombre,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-800 truncate",children:h(t.nombre,r)}),e.jsxs("p",{className:"text-xs text-farma-primary font-bold",children:["$ ",t.precio.toLocaleString("es-AR")]})]})]})},t.id))}),e.jsxs("a",{href:`/buscar?q=${r}`,className:"block text-center text-xs text-farma-primary font-bold bg-white border-t border-farma-muted p-2 hover:underline",children:['Ver todos los resultados para "',r,'"']})]}):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("p",{className:"text-4xl mb-2",children:"ðŸ¤”"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"No encontramos coincidencias"}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Intenta con otro tÃ©rmino o marca."})]})})]})}export{y as default};
