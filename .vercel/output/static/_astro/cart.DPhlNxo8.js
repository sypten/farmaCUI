let u=[],o=0;const y=4,p=e=>{let n=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(r){return t.lc=n.push(r),()=>{for(let l=o+y;l<u.length;)u[l]===r?u.splice(l,y):l+=y;let i=n.indexOf(r);~i&&(n.splice(i,1),--t.lc||t.off())}},notify(r,i){let l=!u.length;for(let a of n)u.push(a,t.value,r,i);if(l){for(o=0;o<u.length;o+=y)u[o](u[o+1],u[o+2],u[o+3]);u.length=0}},off(){},set(r){let i=t.value;i!==r&&(t.value=r,t.notify(i))},subscribe(r){let i=t.listen(r);return r(t.value),i},value:e};return t},w=5,h=6,m=10;let O=(e,n,t,r)=>(e.events=e.events||{},e.events[t+m]||(e.events[t+m]=r(i=>{e.events[t].reduceRight((l,a)=>(a(l),l),{shared:{},...i})})),e.events[t]=e.events[t]||[],e.events[t].push(n),()=>{let i=e.events[t],l=i.indexOf(n);i.splice(l,1),i.length||(delete e.events[t],e.events[t+m](),delete e.events[t+m])}),T=1e3,M=(e,n)=>O(e,r=>{let i=n(r);i&&e.events[h].push(i)},w,r=>{let i=e.listen;e.listen=(...a)=>(!e.lc&&!e.active&&(e.active=!0,r()),i(...a));let l=e.off;return e.events[h]=[],e.off=()=>{l(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let a of e.events[h])a();e.events[h]=[]}},T)},()=>{e.listen=i,e.off=l}});const U=(e={})=>{let n=p(e);return n.setKey=function(t,r){let i=n.value;typeof r>"u"&&t in n.value?(n.value={...n.value},delete n.value[t],n.notify(i,t)):n.value[t]!==r&&(n.value={...n.value,[t]:r},n.notify(i,t))},n};let S=e=>e,E={},d={addEventListener(){},removeEventListener(){}};function I(){try{return typeof localStorage<"u"}catch{return!1}}I()&&(E=localStorage);let R={addEventListener(e,n,t){window.addEventListener("storage",n),window.addEventListener("pageshow",t)},removeEventListener(e,n,t){window.removeEventListener("storage",n),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(d=R);function _(e,n={},t={}){let r=t.encode||S,i=t.decode||S,l=U(),a=l.setKey,L=(s,f)=>{typeof f>"u"?(t.listen!==!1&&d.perKey&&d.removeEventListener(e+s,g,c),delete E[e+s]):(t.listen!==!1&&d.perKey&&!(s in l.value)&&d.addEventListener(e+s,g,c),E[e+s]=r(f))};l.setKey=(s,f)=>{L(s,f),a(s,f)};let N=l.set;l.set=function(s){for(let f in s)L(f,s[f]);for(let f in l.value)f in s||L(f,void 0);N(s)};function g(s){s.key?s.key.startsWith(e)&&(s.newValue===null?a(s.key.slice(e.length),void 0):a(s.key.slice(e.length),i(s.newValue))):N({})}function c(){let s={...n};for(let f in E)f.startsWith(e)&&(s[f.slice(e.length)]=i(E[f]));for(let f in s)l.setKey(f,s[f])}return M(l,()=>{if(c(),t.listen!==!1)return d.addEventListener(e,g,c),()=>{d.removeEventListener(e,g,c);for(let s in l.value)d.removeEventListener(e+s,g,c)}}),l}const v=_("farmacui-cart",{});function q({id:e,name:n,price:t,image:r,slug:i}){const l=v.get()[e];if(l){const a=JSON.parse(l);a.quantity+=1,v.setKey(e,JSON.stringify(a))}else v.setKey(e,JSON.stringify({id:e,name:n,price:t,image:r,slug:i,quantity:1}))}function J(e){v.setKey(e,void 0)}function C(){v.set({})}function K(e){const n=v.get()[e];if(n){const t=JSON.parse(n);t.quantity>1&&(t.quantity-=1,v.setKey(e,JSON.stringify(t)))}}export{q as a,C as b,v as c,K as d,J as r};
