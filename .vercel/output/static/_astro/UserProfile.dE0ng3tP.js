import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as t}from"./index.D55ewHcJ.js";import{s as i}from"./supabase.CKd-pqSN.js";function b(){const[c,o]=t.useState(!0),[r,x]=t.useState(null),[n,m]=t.useState([]);if(t.useEffect(()=>{async function a(){try{const{data:{user:s}}=await i.auth.getUser();if(!s){window.location.href="/login";return}x(s);const{data:l,error:d}=await i.from("ventas").select(`
            *,
            detalle_ventas (
              cantidad,
              precio_final_unitario,
              producto:productos (nombre)
            )
          `).eq("cliente_id",s.id).order("fecha",{ascending:!1});if(d)throw d;m(l||[])}catch(s){console.error("Error cargando perfil:",s)}finally{o(!1)}}a()},[]),c)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-farma-primary mb-4"}),e.jsx("p",{children:"Cargando tu perfil..."})]});if(!r)return null;const f=r.user_metadata?.full_name||r.email;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-farma-accent bg-opacity-30 rounded-full flex items-center justify-center text-3xl mx-auto mb-4",children:"ðŸ‘¤"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 break-words",children:f}),e.jsx("p",{className:"text-gray-500 text-sm mb-4 break-all",children:r.email}),e.jsx("hr",{className:"my-4 border-gray-100"}),e.jsx("div",{className:"text-left text-sm text-gray-600 space-y-2",children:e.jsxs("p",{children:["ðŸ“… Miembro desde: ",new Date(r.created_at).toLocaleDateString()]})}),e.jsx("button",{onClick:async()=>{await i.auth.signOut(),window.location.href="/"},className:"mt-6 w-full border border-farma-error text-farma-error py-2 rounded hover:bg-farma-error hover:bg-opacity-5 text-sm font-bold",children:"Cerrar SesiÃ³n"})]})}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Mis Pedidos"}),n.length>0?e.jsx("div",{className:"space-y-6",children:n.map(a=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:[e.jsxs("div",{className:"bg-white p-4 border-b border-farma-muted flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide block",children:"Orden"}),e.jsxs("p",{className:"font-mono text-gray-800 font-bold",children:["#",a.numero_orden]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide block",children:"Fecha"}),e.jsx("p",{className:"text-gray-700",children:new Date(a.fecha).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide block",children:"Total"}),e.jsxs("p",{className:"text-farma-success font-bold",children:["$ ",a.total_final?.toLocaleString("es-AR")]})]}),e.jsx("div",{children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase inline-block
                      ${a.estado==="pendiente"?"bg-yellow-100 text-yellow-800":a.estado==="completado"?"bg-farma-success bg-opacity-20 text-farma-success":"bg-farma-muted bg-opacity-20 text-farma-text"}`,children:a.estado})})]}),e.jsx("div",{className:"p-4",children:e.jsx("ul",{className:"divide-y divide-gray-100",children:a.detalle_ventas.map((s,l)=>e.jsxs("li",{className:"py-2 flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-700",children:[e.jsxs("span",{className:"font-bold",children:[s.cantidad,"x"]})," ",s.producto?.nombre||"Producto no disponible"]}),e.jsxs("span",{className:"text-gray-500",children:["$ ",s.precio_final_unitario?.toLocaleString("es-AR")]})]},l))})})]},a.id))}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center border border-gray-200",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ›’"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AÃºn no tienes pedidos"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Â¿QuÃ© esperas para estrenar tu carrito?"}),e.jsx("a",{href:"/",className:"text-farma-primary hover:underline font-bold",children:"Ir a la tienda"})]})]})]})}export{b as default};
