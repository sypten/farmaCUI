import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.D55ewHcJ.js";import{c as b}from"./cart.DPhlNxo8.js";import{s as n}from"./supabase.CKd-pqSN.js";function y(){const[c,m]=s.useState(0),[u,d]=s.useState(null),[f,x]=s.useState(!1),[h,p]=s.useState("");s.useEffect(()=>{const r=b.subscribe(i=>{const o=Object.values(i).map(a=>JSON.parse(a)).reduce((a,l)=>a+l.quantity,0);m(o)});return()=>r()},[]),s.useEffect(()=>{const r=async()=>{const{data:{session:t}}=await n.auth.getSession();if(d(t),t){const o=t.user.email||"Usuario",a=t.user.user_metadata?.full_name||o.split("@")[0];p(a);const{data:l}=await n.from("usuarios_sistema").select("rol").eq("id",t.user.id).single();x(!!l)}};r();const{data:{subscription:i}}=n.auth.onAuthStateChange(t=>{(t==="SIGNED_OUT"||t==="SIGNED_IN")&&r()});return()=>i?.unsubscribe()},[]);const g=async()=>{await n.auth.signOut(),window.location.href="/"};return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("a",{href:"/carrito",className:"relative p-2 text-farma-text hover:text-farma-primary transition","aria-label":"Ver Carrito",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),c>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-farma-error text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center animate-bounce",children:c})]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:u?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-farma-text font-medium hidden lg:block truncate max-w-[100px]",children:h}),f&&e.jsx("a",{href:"/admin",className:"bg-gray-800 text-white px-2 py-1 rounded hover:bg-gray-700 flex items-center gap-1 text-xs font-bold",title:"Admin",children:"‚öôÔ∏è"}),e.jsx("a",{href:"/perfil",className:"bg-farma-accent/20 p-2 rounded-full hover:bg-farma-accent/40 transition text-farma-primary",title:"Mi Perfil",children:"üë§"}),e.jsx("button",{onClick:g,className:"text-farma-error hover:text-red-700 font-bold text-xs",children:"Salir"})]}):e.jsxs(e.Fragment,{children:[e.jsx("a",{href:"/login",className:"font-medium text-farma-text hover:text-farma-primary px-2",children:"Ingresar"}),e.jsx("a",{href:"/registro",className:"hidden sm:block bg-farma-primary text-white px-4 py-1.5 rounded-full font-bold hover:bg-farma-secondary transition shadow-sm text-xs",children:"Registrarse"})]})})]})}export{y as default};
